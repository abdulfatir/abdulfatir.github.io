function run(){var t={x1:X0,y1:Y0,x2:0,y2:0},a={x1:0,y1:0,x2:0,y2:0},e={x:X0+l1*Math.sin(theta1),y:Y0+l1*Math.cos(theta1),lastx:0,lasty:0,mass:m1},h={x:X0+l1*Math.sin(theta1)+l2*Math.sin(theta2),y:Y0+l1*Math.cos(theta1)+l2*Math.cos(theta2),lastx:0,lasty:0,mass:m2};clearInterval(init),ctx.clearRect(0,0,canvas.width,canvas.height),ctx2.clearRect(0,0,canvas2.width,canvas2.height),init=setInterval(function(){render(t,a,e,h,ctx,canvas)},10)}function render(t,a,e,h,l,n){mu=1+m1/m2,d2theta1=(g*(sin(theta2)*cos(theta1-theta2)-mu*sin(theta1))-(l2*dtheta2*dtheta2+l1*dtheta1*dtheta1*cos(theta1-theta2))*sin(theta1-theta2))/(l1*(mu-cos(theta1-theta2)*cos(theta1-theta2))),d2theta2=(g*mu*(sin(theta1)*cos(theta1-theta2)-sin(theta2))+(mu*l1*dtheta1*dtheta1+l2*dtheta2*dtheta2*cos(theta1-theta2))*sin(theta1-theta2))/(l2*(mu-cos(theta1-theta2)*cos(theta1-theta2))),theta1+=(dtheta1+=d2theta1*dtime)*dtime,theta2+=(dtheta2+=d2theta2*dtime)*dtime,e.lastx=e.x,e.lasty=e.y,h.lastx=h.x,h.lasty=h.y,e.x=X0+l1*Math.sin(theta1),e.y=Y0+l1*Math.cos(theta1),h.x=X0+l1*Math.sin(theta1)+l2*Math.sin(theta2),h.y=Y0+l1*Math.cos(theta1)+l2*Math.cos(theta2),t.x2=e.x,t.y2=e.y,a.x1=e.x,a.y1=e.y,a.x2=h.x,a.y2=h.y,l.clearRect(0,0,n.width,n.height),drawSupport(l),drawThread(t,l),drawThread(a,l),drawBob(e,l),drawBob(h,l),drawTrail(e,h,l)}function drawSupport(t){t.beginPath(),t.arc(X0,Y0,3,0,2*Math.PI),t.fillStyle="#00f",t.fill(),t.lineWidth=1,t.stroke()}function drawThread(t,a){a.beginPath(),a.moveTo(t.x1,t.y1),a.lineTo(t.x2,t.y2),a.strokeStyle="#000",a.lineWidth=3,a.stroke()}function drawBob(t,a){a.beginPath(),a.arc(t.x,t.y,t.mass,0,2*Math.PI),a.fillStyle="#ff0000",a.fill(),a.lineWidth=1,a.stroke()}function drawTrail(t,a){ctx2.beginPath(),ctx2.moveTo(a.lastx,a.lasty),ctx2.lineTo(a.x,a.y),ctx2.strokeStyle="#00f",ctx2.lineWidth=2,ctx2.stroke()}var theta1=3*Math.PI/4,theta2=Math.PI/2,dtheta1=0,dtheta2=0,d2theta1=0,d2theta2=0,X0=250,Y0=150,g=15,m1=10,m2=10,l1=80,l2=80,dtime=.05,cos=Math.cos,sin=Math.sin,canvas=document.getElementById("pend-canvas"),ctx=canvas.getContext("2d"),canvas2=document.getElementById("trail-canvas"),ctx2=canvas2.getContext("2d"),init={};run(),$(document).ready(function(){$("#reset").click(function(){m1=$("#m1").val(),m2=$("#m2").val(),theta1=$("#theta1").val()*Math.PI/180,theta2=$("#theta2").val()*Math.PI/180,l1=$("#l1").val(),l2=$("#l2").val(),g=$("#g").val(),dtheta1=0,dtheta2=0,d2theta1=0,d2theta2=0,run()})});